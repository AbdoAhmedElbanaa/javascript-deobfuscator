<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>jsdfe: JavaScript Deobfuscator Full of Excuses</title>
<style type="text/css">
body {
	background-color: beige;
}
#title {
	font: bold x-large sans-serif;
}
#opts {
	width: 99%;
}
#opts input {
	margin-left: 1em;
}
textarea {
	width: 99%;
}
iframe {
	width: 99%;
	height: 4em;
}
button {
	margin-top: 5px;
	font-size: inherit;
}
a.button {
	text-decoration: none;
	font-size: inherit;
	background-color: #EEEEEE;
	border:  solid thin;
	padding: 0 0.3em;
	cursor: default;
	color: black;
}
a.button:hover {
	background-color: #CCCCCC;
}
.hide {
	display: none;
}
</style>
<script src="./jsdfe.modules.bundle.min.js"></script>
<script src="./jsdfe.bundle.min.ob.js"></script>
</head>
<body>
<div>
<span id="title">jsdfe: JavaScript Deobfuscator Full of Excuses</span>
<button id="hide-excuses">Hide/Show Excuses</button>
</div>
<ul id="excuses">
<li>The purpose of this program is to make obfuscated scripts easier to read and help you understand their roughly behavior, not to try to reproduce the original script in an executable form.</li>
<li>This program is built on nodejs and babel.</li>
<li>It is a program designed to run on a PC console, and functioning in a browser is only a byproduct, and execution speed is slow.</li>
<li>It is a program made for personal use. It often terminates with an uncaught error and sometimes goes into an infinite loop and freezes and executes some code of the target script in a vm (iframe) without considering security.</li>
<li>The progress is output to the console of the developer tools.</li>
<li>Please make sure you understand the above before executing.</li>
<li><a href="https://github.com/avotoko/javascript-deobfuscator">github repository</a>.</li>
</ul>
<div id="opts">Options:
</div>
<span>[*] Sacrifice accuracy.</span>
<div>
Input (Paste text or drop file):<br />
<textarea id="input" rows="14" spellcheck="false"></textarea><br />
<button id="run">Deobfuscate</button>
<a id="download" class="button" download="output.js">Download output</a>
<button id="copy">Copy output to clipboard</button>
<button id="clear">Clear output</button>
<button id="runCode" class="hide">Run code in vm(iframe)</button>
</div>
<div>
Output:<br />
<textarea id="output" rows="13" spellcheck="false"></textarea><br />
</div>
<script>
if (location.protocol !== "file:"){
	let e = document.createElement("iframe");
	e.src = "https://avotoko.blogspot.com/2021/10/i-want-to-know-number-of-accesses.html#note";
	document.body.appendChild(e);
}
document.addEventListener("DOMContentLoaded", ()=>{
	let d = document;
	let {decode} = window["sd-decoder"];
	let local = location.protocol === "file:",
		opts = {"brute": false, "eval-atob": false, "eval-assign [*]": false, "remove-unreferenced [*]": false, "string-expander-c-remove-extra [*]":false, "beta":false, "l-debug": false, "l-print-delived-expander":false, "l-print-scope":false, "l-suppress":false};
	let container = document.getElementById("opts");
	Object.keys(opts).forEach(k=>{
		if (k.startsWith("l-")){
			if (! local){ return; }
			k = k.substring(2);
		}
		let e = document.createElement("input");
		e.type = "checkbox", e.id = k.split(" ")[0], e.checked = opts[k];
		container.appendChild(e);
		e = document.createElement("label");
		e.for = k, e.textContent = k;
		container.appendChild(e);
	});
	if (local){
		d.getElementById("runCode").classList.remove("hide");
	}
	d.getElementById("hide-excuses").addEventListener("click", (ev)=>{
		d.getElementById("excuses").classList.toggle("hide");
	});
	let input = d.getElementById("input"), output = d.getElementById("output");
	input.value = `var a = atob("aGVsbG8="); // 'eval-atob' replaces the right hand with the evaluated value.
var b; // 'remove-unreferenced' remove this statement.
a = "Hey", a += " gays!"; // 'eval-assign' evaluate this assignment expression.
console.log(a); // 'eval-assign' will replace variables with literals if possible.
// deobfuscate followings.
(function(_0x7f3edf,_0x62db19){var _0x3ea4da=_0x4913,_0x2b5775=_0x7f3edf();while(!![]){try{var _0x25475e=parseInt(_0x3ea4da(0x100))/0x1*(-parseInt(_0x3ea4da(0x103))/0x2)+parseInt(_0x3ea4da(0x107))/0x3*(-parseInt(_0x3ea4da(0x106))/0x4)+-parseInt(_0x3ea4da(0x10a))/0x5*(parseInt(_0x3ea4da(0x109))/0x6)+parseInt(_0x3ea4da(0x104))/0x7*(parseInt(_0x3ea4da(0x10b))/0x8)+-parseInt(_0x3ea4da(0x102))/0x9+parseInt(_0x3ea4da(0x105))/0xa*(-parseInt(_0x3ea4da(0x101))/0xb)+-parseInt(_0x3ea4da(0x108))/0xc*(-parseInt(_0x3ea4da(0x10c))/0xd);if(_0x25475e===_0x62db19)break;else _0x2b5775['push'](_0x2b5775['shift']());}catch(_0x11878b){_0x2b5775['push'](_0x2b5775['shift']());}}}(_0x1f46,0xce4d4));function hi(){var _0x44d8d2=_0x4913;console['log'](_0x44d8d2(0x10d));}function _0x4913(_0x42a11e,_0x28997d){var _0x1f46da=_0x1f46();return _0x4913=function(_0x491324,_0x5d00ae){_0x491324=_0x491324-0x100;var _0x3b893a=_0x1f46da[_0x491324];return _0x3b893a;},_0x4913(_0x42a11e,_0x28997d);}hi();function _0x1f46(){var _0x10a357=['249025SGjcqe','24OVDaZa','13229021IDBuND','Hello\x20World!','307kbyHvP','55mToEHJ','12390849AzERbI','1062ZWnvKY','3285268vpUaeV','2257250cenXBc','4zdkifI','2692809xIonWD','36scJefO','6jLhlFK'];_0x1f46=function(){return _0x10a357;};return _0x1f46();}`;
	input.addEventListener("dragover", function(ev){
		ev.preventDefault();
	});
	input.addEventListener("drop", function(ev){
		ev.preventDefault();
		if (ev.dataTransfer.files.length > 0){
			let file = ev.dataTransfer.files[0];
			if (file.type.startsWith("text/") || file.type === "application/x-javascript"){
				file.text().then(text=>{
					d.getElementById("input").value = text;
				});
			}
			else {
				console.log("dropped file type not supported:", file.type);
			}
		}
	});
	d.getElementById("run").addEventListener("click", function(){
		let opts = {}, code = input.value;
		document.querySelectorAll('#opts > input[type="checkbox"]').forEach(e=>{
			if (e.checked){
				if (e.id.startsWith("remove-") && e.id !== "remove-ex"){
					opts.remove = opts.remove || "";
					opts.remove += "," + e.id.substring(7);
				}
				else {
					opts[e.id] = true;
				}
			}
		});
		opts["remove-intermediate"] = true;
		output.value = "Start deobfuscating. See the console of the developer tools for the progress.";
		if (window.jsdfeOpts){
			opts = Object.assign({}, window.jsdfeOpts, opts);
		}
		console.log("using options:", opts);
		setTimeout(function(){
			try {
				let res = decode(code, opts);
				output.value = res.modified > 0 ? res.code : "Unable to deobfuscate";
				d.querySelectorAll(".jsdfe-vm").forEach(e=>e.remove());
			}
			catch(e){
				output.value = (e.type ? e.type : "error:") + " " + e.message;
				d.querySelectorAll(".jsdfe-vm").forEach(e=>e.remove());
				throw e;
			}
		}, 0);
	});
	d.getElementById("copy").addEventListener("click", function(){
		output.select();
		document.execCommand("copy");
		output.selectionEnd = output.selectionStart;
	});
	d.getElementById("download").addEventListener("click", function(ev){
		let a = ev.target;
		console.log(a);
		a.href = URL.createObjectURL(new Blob([output.value],{type:"application/javascript"}));
	});
	d.getElementById("clear").addEventListener("click", function(){
		output.value = "";
	});
	d.getElementById("runCode").addEventListener("click", function(){
		let opts = {run: "run-in-vm"};
		let code = d.getElementById("input").value;
		d.getElementById("output").value = "Start the script.";
		let res = decode(code, opts);
		output.value = "The script has finished.";
	});
});
</script>
</body>
</html>
